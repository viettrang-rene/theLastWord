<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Puzzle Fun Generator</title>
  <style>
    body {
      font-family: Arial, sans-serif;
      padding: 20px;
      background-color: #fff;
      color: #000;
    }
    h1, h2 {
      text-align: center;
    }
    .theme-green { --accent: green; }
    .theme-brown { --accent: brown; }
    .theme-blue { --accent: blue; }
    :root {
      --accent: #000;
    }
    .accent {
      color: var(--accent);
    }
    textarea {
      width: 100%;
      height: 100px;
    }
    .button-group button {
      margin: 5px;
      padding: 8px 16px;
    }
    .preview, .pdf-output {
      margin-top: 20px;
    }
  </style>
</head>
<body>
  <h1 class="accent">Puzzle Fun!</h1>
  <h2 class="accent">Made by Rene</h2>
  <p><strong>Student name:</strong> ________________</p>

  <div class="input-section">
    <textarea id="wordInput" placeholder="Enter words (e.g., apple, banana, dolphin) or choose a theme below."></textarea>
    <div class="button-group">
      <button id="easyBtn" style="background: green; color: white">Easy Animals</button>
      <button id="farmBtn" style="background: brown; color: white">Farm Animals</button>
      <button id="oceanBtn" style="background: blue; color: white">Ocean Animals</button>
      <button id="resetBtn">Reset</button>
      <button id="generateBtn">Generate PDF</button>
    </div>
  </div>

  <div class="preview" id="previewArea"></div>

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
  <script>
    const themes = {
      easy: { words: ["cat", "dog", "bat", "fox", "owl", "rat", "bee", "ant"], color: 'green', class: 'theme-green' },
      farm: { words: ["cow", "pig", "goat", "sheep", "horse", "duck", "hen", "dog"], color: 'brown', class: 'theme-brown' },
      ocean: { words: ["shark", "whale", "fish", "crab", "octopus", "seal", "eel", "dolphin"], color: 'blue', class: 'theme-blue' }
    };

    function loadTheme(theme) {
      const { words, class: themeClass } = themes[theme];
      document.getElementById("wordInput").value = words.join(", ");
      document.body.className = themeClass;
    }

    function resetInput() {
      document.getElementById("wordInput").value = "";
      document.body.className = "";
    }

    function shuffle(word) {
      const arr = word.split("");
      for (let i = arr.length - 1; i > 0; i--) {
        const j = Math.floor(Math.random() * (i + 1));
        [arr[i], arr[j]] = [arr[j], arr[i]];
      }
      return arr.join("");
    }

    function generateWordSearch(words, size = 12) {
      const grid = Array.from({ length: size }, () => Array(size).fill(""));
      const directions = [
        [0, 1], [1, 0], [1, 1], [-1, 1]
      ];
      function placeWord(word) {
        for (let attempt = 0; attempt < 100; attempt++) {
          const dir = directions[Math.floor(Math.random() * directions.length)];
          const x = Math.floor(Math.random() * size);
          const y = Math.floor(Math.random() * size);
          let fit = true;
          for (let i = 0; i < word.length; i++) {
            const nx = x + dir[0] * i;
            const ny = y + dir[1] * i;
            if (nx < 0 || ny < 0 || nx >= size || ny >= size || (grid[nx][ny] && grid[nx][ny] !== word[i])) {
              fit = false;
              break;
            }
          }
          if (fit) {
            for (let i = 0; i < word.length; i++) {
              const nx = x + dir[0] * i;
              const ny = y + dir[1] * i;
              grid[nx][ny] = word[i];
            }
            return true;
          }
        }
        return false;
      }
      words.forEach(word => placeWord(word.toUpperCase()));
      for (let i = 0; i < size; i++) {
        for (let j = 0; j < size; j++) {
          if (!grid[i][j]) grid[i][j] = String.fromCharCode(65 + Math.floor(Math.random() * 26));
        }
      }
      return grid;
    }

    function generatePDF() {
      const raw = document.getElementById("wordInput").value;
      let words = raw.split(/[\n,]+/).map(w => w.trim().toLowerCase()).filter(w => /^[a-zA-Z]+$/.test(w));

      if (words.length === 0) {
        alert("Only letters allowed. Please try again!");
        return;
      }

      const scrambled = words.map(w => shuffle(w));
      const grid = generateWordSearch(words);

      const { jsPDF } = window.jspdf;
      const doc = new jsPDF();
      doc.setFontSize(16);
      doc.text("Puzzle Fun!", 105, 20, null, null, 'center');
      doc.setFontSize(12);
      doc.text("Made by Rene", 105, 28, null, null, 'center');
      doc.text("Student name: ________________", 20, 38);

      // Crossword Clues
      let y = 48;
      doc.setFontSize(14);
      doc.text("Crossword Clues (scrambled):", 20, y);
      y += 10;
      for (let i = 0; i < scrambled.length; i++) {
        if (y > 270) {
          doc.addPage();
          y = 20;
          doc.setFontSize(14);
          doc.text("Crossword Clues (continued):", 20, y);
          y += 10;
        }
        doc.text(`${i + 1}. ${scrambled[i]} (${words[i].length} letters)`, 25, y);
        y += 8;
      }

      // Word Search Grid
      if (y > 200) {
        doc.addPage();
        y = 20;
      } else {
        y += 10;
      }
      doc.setFontSize(14);
      doc.text("Word Search:", 20, y);
      y += 10;
      doc.setFontSize(10);
      grid.forEach((row, i) => {
        if (y > 270) {
          doc.addPage();
          y = 20;
        }
        doc.text(row.join(" "), 25, y);
        y += 5;
      });

      // Word Bank
      if (y > 240) {
        doc.addPage();
        y = 20;
      } else {
        y += 10;
      }
      doc.setFontSize(12);
      doc.text("Word Bank:", 20, y);
      y += 8;
      words.forEach((w, i) => {
        if (y > 270) {
          doc.addPage();
          y = 20;
        }
        doc.text(w, 25, y);
        y += 6;
      });

      doc.save("puzzle_fun.pdf");
    }

    document.getElementById("easyBtn").addEventListener("click", () => loadTheme('easy'));
    document.getElementById("farmBtn").addEventListener("click", () => loadTheme('farm'));
    document.getElementById("oceanBtn").addEventListener("click", () => loadTheme('ocean'));
    document.getElementById("resetBtn").addEventListener("click", resetInput);
    document.getElementById("generateBtn").addEventListener("click", generatePDF);
  </script>
</body>
</html>
